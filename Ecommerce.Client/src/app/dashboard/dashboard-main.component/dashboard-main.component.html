<div class="dashboard-content">
  <!-- Dashboard Header -->
  <div class="dashboard-header">
    <div class="header-left">
      <h1>E-Commerce Analytics</h1>
      <ul class="breadcrumb">
        <li><a href="#">Dashboard</a></li>
        <li>/</li>
        <li><a href="#" class="active">Overview</a></li>
      </ul>
    </div>
    <button (click)="refreshDashboard()" class="refresh-btn">
      <i class="fas fa-sync-alt"></i>
      <span>Refresh Data</span>
    </button>
  </div>

  <!-- Insights Cards - Full width grid -->
  <div class="insights-grid">
    <div class="insight-card total-orders">
      <div class="card-icon">
        <i class="fas fa-shopping-bag"></i>
      </div>
      <div class="card-content">
        <h3 class="card-value">{{totalOrders | number}}</h3>
        <p class="card-label">Total Orders</p>
        <span class="card-trend" [class.positive]="orderGrowth >= 0" [class.negative]="orderGrowth < 0">
          <i class="fas" [ngClass]="orderGrowth >= 0 ? 'fa-arrow-up' : 'fa-arrow-down'"></i>
          {{orderGrowth >= 0 ? '+' : ''}}{{orderGrowth | number:'1.1-1'}}%
        </span>
      </div>
    </div>

    <div class="insight-card total-users">
      <div class="card-icon">
        <i class="fas fa-users"></i>
      </div>
      <div class="card-content">
        <h3 class="card-value">{{totalUsers | number}}</h3>
        <p class="card-label">Total Users</p>
        <span class="card-trend" [class.positive]="userGrowth >= 0" [class.negative]="userGrowth < 0">
          <i class="fas" [ngClass]="userGrowth >= 0 ? 'fa-arrow-up' : 'fa-arrow-down'"></i>
          {{userGrowth >= 0 ? '+' : ''}}{{userGrowth | number:'1.1-1'}}%
        </span>
      </div>
    </div>

    <div class="insight-card total-products">
      <div class="card-icon">
        <i class="fas fa-boxes"></i>
      </div>
      <div class="card-content">
        <h3 class="card-value">{{totalProducts | number}}</h3>
        <p class="card-label">Products in Store</p>
        <span class="card-trend" [class.positive]="productGrowth >= 0" [class.negative]="productGrowth < 0">
          <i class="fas" [ngClass]="productGrowth >= 0 ? 'fa-arrow-up' : 'fa-arrow-down'"></i>
          {{productGrowth >= 0 ? '+' : ''}}{{productGrowth | number:'1.1-1'}}%
        </span>
      </div>
    </div>

    <div class="insight-card total-revenue">
      <div class="card-icon">
        <i class="fas fa-chart-line"></i>
      </div>
      <div class="card-content">
        <h3 class="card-value">{{formatCurrency(totalRevenue)}}</h3>
        <p class="card-label">Total Revenue</p>
        <span class="card-trend" [class.positive]="revenueGrowth >= 0" [class.negative]="revenueGrowth < 0">
          <i class="fas" [ngClass]="revenueGrowth >= 0 ? 'fa-arrow-up' : 'fa-arrow-down'"></i>
          {{revenueGrowth >= 0 ? '+' : ''}}{{revenueGrowth | number:'1.1-1'}}%
        </span>
      </div>
    </div>
  </div>

  <!-- Charts Section - All charts full width -->
  <div class="charts-section">
    <!-- Sales Chart - Full width -->
    <div class="chart-card full-width">
      <div class="chart-header">
        <div class="header-left">
          <h3><i class="fas fa-chart-line"></i> Revenue & Orders Overview</h3>
          <p class="chart-subtitle">Monthly performance analysis</p>
        </div>
        <div class="chart-controls">
          <select class="period-select" (change)="onPeriodChange($event)">
            <option value="7">Last 7 days</option>
            <option value="30" selected>Last 30 days</option>
            <option value="90">Last 3 months</option>
            <option value="365">Last 12 months</option>
          </select>
        </div>
      </div>
      <div class="chart-container">
        <canvas #salesChart></canvas>
      </div>
    </div>

    <!-- Revenue by Brand - Full width -->
    <div class="chart-card full-width">
      <div class="chart-header">
        <h3><i class="fas fa-tags"></i> Revenue by Brand</h3>
        <p class="chart-subtitle">Distribution across product brands</p>
      </div>
      <div class="chart-container">
        <canvas #categoryChart></canvas>
      </div>
    </div>

    <!-- Top Products - Full width -->
    <div class="chart-card full-width">
      <div class="chart-header">
        <h3><i class="fas fa-trophy"></i> Top Products</h3>
        <p class="chart-subtitle">Best selling items based on sales and revenue</p>
      </div>
      <div class="products-container">
        @if (topProducts.length === 0) {
          <div class="empty-state">
            <i class="fas fa-box-open"></i>
            <h4>No Products Found</h4>
            <p>No product data available yet.</p>
          </div>
        } @else {
          <div class="top-products-list">
            @for (product of topProducts; track product.id; let i = $index) {
              <div class="product-item">
                <div class="product-rank">{{i + 1}}</div>
                <img [src]="product.image || 'https://via.placeholder.com/50'"
                     [alt]="product.name"
                     class="product-image"
                     (error)="product.image = 'https://via.placeholder.com/50'">
                <div class="product-info">
                  <h4 [title]="product.name">{{product.name}}</h4>
                  <div class="product-meta">
                    <span class="product-brand">{{product.brand}}</span>
                    <div class="product-rating">
                      <i class="fas fa-star"></i>
                      <span>{{product.rating | number:'1.1-1'}}</span>
                      <small>({{product.reviews}})</small>
                    </div>
                  </div>
                </div>
                <div class="product-stats">
                  <div class="sales-info">
                    <span class="sales-count">{{product.sales | number}} sold</span>
                    <span class="product-revenue">{{formatCurrency(product.revenue)}}</span>
                  </div>
                  <div class="sales-progress">
                    <div class="progress-bar" [style.width.%]="getSalesPercentage(product)"></div>
                  </div>
                </div>
              </div>
            }
          </div>
        }
      </div>
    </div>
  </div>
</div>
